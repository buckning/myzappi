<div *ngIf="registered === false">
    <app-register-panel [bearerToken]="bearerToken" (registeredEvent)="registeredEvent()"></app-register-panel>
</div>


<div class="tile" *ngIf="hubDetails == null && registered !== false">
    <p>
        Loading your details...
    </p>
</div>

<div *ngIf="registered === true && hubDetails !== null">
    <div *ngIf="registeredThisSession === true">
        <app-help-panel></app-help-panel>
    </div>
    <br>
    <div *ngIf="tariffsRegistered === true">
        <app-energy-cost-panel [bearerToken]="bearerToken"></app-energy-cost-panel>
        <br>
    </div>
    <app-tariff-panel [bearerToken]="bearerToken" (tariffChangeEvent)="tariffChangeEvent()"></app-tariff-panel>
    <br>
    <app-schedules-panel [bearerToken]="bearerToken" [hubDetails]="hubDetails"></app-schedules-panel>
    <br>
    <div *ngIf="hubDetails != null">
        <div class="tile">
            <div>
                <h1>Devices</h1>
            </div>

            <div *ngIf="loadingDevices === true">
                <p>
                    Loading your devices...
                </p>
            </div>

            <div *ngIf="loadingDevices === false">
                <div>
                    <table id="devicesTable" class="devicesTable">
                        <tbody>
                          <tr *ngFor="let row of devices; let i = index">
                            <div *ngIf="row.deviceClass === 'ZAPPI'">
                                <app-zappi-panel [serialNumber]="row.serialNumber" [bearerToken]="bearerToken"></app-zappi-panel>
                            </div>
                            <div *ngIf="row.deviceClass === 'LIBBI'">
                                <app-libbi-panel [serialNumber]="row.serialNumber" [bearerToken]="bearerToken"></app-libbi-panel>
                            </div>
                              <div *ngIf="row.deviceClass === 'EDDI'">
                                <b>{{row.deviceClass}}</b>: {{row.serialNumber}}
                                <br>
                                Heater 1: {{row.tank1Name}}
                                <br>
                                Heater 2: {{row.tank2Name}}
                            </div>
                            <br>
                          </tr>
                        </tbody>
                    </table>
                </div>
                <br>
                <button (click)="refreshDeploymentDetails()" class="confirmButton">Refresh</button>
                <button (click)="deleteZappi()" id="forgetMyDetailsButton" class="destructiveButton">
                    Unregister
                </button>
            </div>
        </div>
    </div>
    <br>
    <div *ngIf="registeredThisSession !== true">
        <app-help-panel></app-help-panel>
    </div>
    <div class="bmc">
        <a href="https://www.buymeacoffee.com/andrewmcglynn">
            <img src="https://myzappi-site.s3.eu-west-1.amazonaws.com/bmc_qr.png" width="100" height="100" alt="Help keep the servers running">
        </a>
    </div>
</div>

<div class="logoutButtonContainer">
    <button (click)="logOut()" class="confirmButton" id="logoutButton">Logout</button>
</div>
